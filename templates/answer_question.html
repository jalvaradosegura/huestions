{% extends "base.html" %}
{% block main %}

<div id="copy-to-clipboard-div" class="alert alert-info alert-dismissible text-center" role="alert" style="display:none">
  <strong>Copied!</strong> List copied to your clipboard, share with your friends 
</div>

<p>{{ questionlist.title }}</p>

{% for question in questions %}
  <h1>{{ question.title }}</h1>
  <form action="" method="post">
    {% csrf_token %}
    {{ form }}
    <input type="hidden" name="question_list_id" value="{{ questionlist.id }}">
    {% if questions.has_next %}
      <input type="hidden" name="next_page" value="{{ questions.next_page_number }}">
    {% endif %}
    <input id="button_to_vote" type="submit" value="answer">
  </form>
{% endfor %}

<div class="pagination">
  <span class="step-links">
    {% if questions.has_previous %}
      <a href="?page=1">&laquo; first</a>
      <a href="?page={{ questions.previous_page_number }}">previous</a>
    {% endif %}

    <span class="current" id="current_question">
      Page {{ questions.number }} of {{ questions.paginator.num_pages }}.
    </span>

    {% if questions.has_next %}
      <a href="?page={{ questions.next_page_number }}">next</a>
      <a href="?page={{ questions.paginator.num_pages }}">last &raquo;</a>
    {% endif %}
  </span>
</div>

{% if already_voted %}
 Question already answered. Your vote won't count this time. 
{% endif %}

<button onclick="copyToClipboard()" class="btn btn-secondary"><span class="glyphicon glyphicon-copy"></span>Share list</button>
<script>
    function showThenHideDiv(){
	document.getElementById("copy-to-clipboard-div").style.display = 'block';
	setTimeout(function(){
        document.getElementById("copy-to-clipboard-div").style.display = 'none';
        }, 5000);
    }

    function copyToClipboard(){
	const el = document.createElement('textarea');
	el.value = '{{ request.build_absolute_uri }}';
	document.body.appendChild(el);
	el.select();
	el.setSelectionRange(0, 99999);
	document.execCommand('copy');
	document.body.removeChild(el);
	showThenHideDiv();
    }
</script>
{% endblock main %}
